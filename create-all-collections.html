<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>åˆ›å»ºæ‰€æœ‰é›†åˆ - PocketBase</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            max-width: 900px;
            margin: 0 auto;
        }

        h1 {
            color: white;
            text-align: center;
            margin-bottom: 30px;
            font-size: 2.5rem;
        }

        .card {
            background: white;
            border-radius: 12px;
            padding: 30px;
            margin-bottom: 20px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.2);
        }

        .status {
            padding: 15px;
            border-radius: 8px;
            margin: 10px 0;
        }

        .status.success {
            background: #d4edda;
            color: #155724;
            border-left: 4px solid #28a745;
        }

        .status.error {
            background: #f8d7da;
            color: #721c24;
            border-left: 4px solid #dc3545;
        }

        .status.info {
            background: #d1ecf1;
            color: #0c5460;
            border-left: 4px solid #17a2b8;
        }

        button {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            padding: 14px 28px;
            border-radius: 8px;
            font-size: 1.1rem;
            font-weight: 600;
            cursor: pointer;
            margin: 10px 5px;
        }

        button:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(102, 126, 234, 0.4);
        }

        button:disabled {
            opacity: 0.6;
            cursor: not-allowed;
        }

        .loading {
            display: inline-block;
            width: 20px;
            height: 20px;
            border: 3px solid rgba(255,255,255,.3);
            border-radius: 50%;
            border-top-color: white;
            animation: spin 1s ease-in-out infinite;
        }

        @keyframes spin {
            to { transform: rotate(360deg); }
        }

        pre {
            background: #f8f9fa;
            padding: 15px;
            border-radius: 8px;
            overflow-x: auto;
            margin: 10px 0;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>ğŸ”§ åˆ›å»ºæ‰€æœ‰é›†åˆ</h1>

        <div class="card">
            <h2>è¯´æ˜</h2>
            <div class="status info">
                <p><strong>âš ï¸ é‡è¦æç¤ºï¼š</strong></p>
                <p>PocketBase çš„é›†åˆåªèƒ½é€šè¿‡ç®¡ç†ç•Œé¢åˆ›å»ºï¼Œä¸èƒ½é€šè¿‡ JavaScript API åˆ›å»ºã€‚</p>
                <p>è¯·æŒ‰ç…§ä¸‹é¢çš„æ­¥éª¤åœ¨ç®¡ç†ç•Œé¢ä¸­æ‰‹åŠ¨åˆ›å»ºé›†åˆã€‚</p>
            </div>
        </div>

        <div class="card">
            <h2>ç¬¬ä¸€æ­¥ï¼šæ‰“å¼€ç®¡ç†ç•Œé¢</h2>
            <button onclick="openAdmin()">ğŸ”§ æ‰“å¼€ PocketBase ç®¡ç†ç•Œé¢</button>
            <p style="margin-top: 10px;">æˆ–è®¿é—®: <a href="http://127.0.0.1:8090/_/" target="_blank">http://127.0.0.1:8090/_/</a></p>
        </div>

        <div class="card">
            <h2>ç¬¬äºŒæ­¥ï¼šåˆ›å»º tournaments é›†åˆ</h2>
            <ol style="line-height: 2;">
                <li>ç‚¹å‡»å·¦ä¾§ <strong>"Collections"</strong></li>
                <li>ç‚¹å‡» <strong>"+ New collection"</strong></li>
                <li><strong>Name:</strong> <code>tournaments</code></li>
                <li><strong>Type:</strong> Base collection</li>
                <li>ç‚¹å‡» <strong>"Create"</strong></li>
                <li>æ·»åŠ ä»¥ä¸‹å­—æ®µ (ç‚¹å‡» "+ New field"):</li>
            </ol>
            
            <pre>name               - Text (Required âœ…)
title              - Text
description        - Text
startDate          - Text
endDate            - Text
registrationDeadline - Text
location           - Text
type               - Text
status             - Text
price              - Number
organizer          - Text
contact            - Text
category           - Text</pre>

            <p><strong>API Rules (é‡è¦!):</strong></p>
            <ul style="line-height: 2;">
                <li><strong>List/Search:</strong> ç•™ç©º (å…è®¸æ‰€æœ‰äººæŸ¥çœ‹)</li>
                <li><strong>View:</strong> ç•™ç©º</li>
                <li><strong>Create:</strong> <code>@request.auth.id != ""</code></li>
                <li><strong>Update:</strong> <code>@request.auth.id != ""</code></li>
                <li><strong>Delete:</strong> <code>@request.auth.id != ""</code></li>
            </ul>
        </div>

        <div class="card">
            <h2>ç¬¬ä¸‰æ­¥ï¼šåˆ›å»º topics é›†åˆ</h2>
            <ol style="line-height: 2;">
                <li>ç‚¹å‡» <strong>"+ New collection"</strong></li>
                <li><strong>Name:</strong> <code>topics</code></li>
                <li><strong>Type:</strong> Base collection</li>
                <li>ç‚¹å‡» <strong>"Create"</strong></li>
                <li>æ·»åŠ ä»¥ä¸‹å­—æ®µ:</li>
            </ol>
            
            <pre>text               - Text (Required âœ…)
explanation        - Text
area               - Text
language           - Text
tournament         - Text</pre>

            <p><strong>API Rules:</strong></p>
            <ul style="line-height: 2;">
                <li><strong>List/Search:</strong> ç•™ç©º</li>
                <li><strong>View:</strong> ç•™ç©º</li>
                <li><strong>Create:</strong> <code>@request.auth.id != ""</code></li>
                <li><strong>Update:</strong> <code>@request.auth.id != ""</code></li>
                <li><strong>Delete:</strong> <code>@request.auth.id != ""</code></li>
            </ul>
        </div>

        <div class="card">
            <h2>ç¬¬å››æ­¥ï¼šåˆ›å»º timer_projects é›†åˆ</h2>
            <ol style="line-height: 2;">
                <li>ç‚¹å‡» <strong>"+ New collection"</strong></li>
                <li><strong>Name:</strong> <code>timer_projects</code></li>
                <li><strong>Type:</strong> Base collection</li>
                <li>ç‚¹å‡» <strong>"Create"</strong></li>
                <li>æ·»åŠ ä»¥ä¸‹å­—æ®µ:</li>
            </ol>
            
            <pre>name               - Text (Required âœ…)
description        - Text
type               - Text (Required âœ…)
duration           - Number
createdBy          - Text (Required âœ…)</pre>

            <p><strong>API Rules:</strong></p>
            <ul style="line-height: 2;">
                <li><strong>List/Search:</strong> ç•™ç©º</li>
                <li><strong>View:</strong> ç•™ç©º</li>
                <li><strong>Create:</strong> <code>@request.auth.id != ""</code></li>
                <li><strong>Update:</strong> <code>@request.auth.id != ""</code></li>
                <li><strong>Delete:</strong> <code>@request.auth.id != ""</code></li>
            </ul>
        </div>

        <div class="card">
            <h2>ç¬¬äº”æ­¥ï¼šéªŒè¯é›†åˆ</h2>
            <button onclick="checkCollections()">âœ… æ£€æŸ¥æ‰€æœ‰é›†åˆ</button>
            <div id="result"></div>
        </div>

        <div class="card">
            <h2>ç¬¬å…­æ­¥ï¼šåˆ·æ–°åº”ç”¨</h2>
            <p>åˆ›å»ºå®Œæ‰€æœ‰é›†åˆåï¼Œåˆ·æ–°æ‚¨çš„åº”ç”¨é¡µé¢ï¼š</p>
            <button onclick="refreshApp()">ğŸ”„ åˆ·æ–°åº”ç”¨</button>
        </div>
    </div>

    <script>
        const POCKETBASE_URL = 'http://127.0.0.1:8090';

        function openAdmin() {
            window.open(`${POCKETBASE_URL}/_/`, '_blank');
        }

        function refreshApp() {
            window.open('http://localhost:5173', '_blank');
        }

        async function checkCollections() {
            const resultDiv = document.getElementById('result');
            resultDiv.innerHTML = '<div class="status info"><span class="loading"></span> æ£€æŸ¥ä¸­...</div>';

            const collections = ['users', 'tournaments', 'topics', 'timer_projects'];
            let results = '';

            for (const collection of collections) {
                try {
                    const response = await fetch(`${POCKETBASE_URL}/api/collections/${collection}/records?perPage=1`);
                    const data = await response.json();

                    if (response.ok) {
                        results += `
                            <div class="status success">
                                âœ… <strong>${collection}</strong> é›†åˆå­˜åœ¨ (${data.totalItems || 0} æ¡è®°å½•)
                            </div>
                        `;
                    } else {
                        results += `
                            <div class="status error">
                                âŒ <strong>${collection}</strong> é›†åˆä¸å­˜åœ¨ - è¯·åˆ›å»ºå®ƒ
                            </div>
                        `;
                    }
                } catch (error) {
                    results += `
                        <div class="status error">
                            âŒ <strong>${collection}</strong> æ£€æŸ¥å¤±è´¥: ${error.message}
                        </div>
                    `;
                }
            }

            resultDiv.innerHTML = results;
        }

        // Auto-check on load
        window.addEventListener('load', () => {
            setTimeout(checkCollections, 500);
        });
    </script>
</body>
</html>



